

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Visualising the Legendre Transform - Danny Wood</title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Danny Wood">
<meta property="og:title" content="Visualising the Legendre Transform">


  <link rel="canonical" href="http//localhost:4000/posts/2023/02/visualising_the_legendre_transform/">
  <meta property="og:url" content="http//localhost:4000/posts/2023/02/visualising_the_legendre_transform/">



  <meta property="og:description" content="The Legendre transform is incredibly useful in a wide range of areas including physics, economics, statistics and machine learning. However, its definition can be somewhat opaque. In this post, we look at how we might gain intuition for how the definition works by constructing it from scratch in a visual way.">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2023-02-04T00:00:00-08:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Danny Wood",
      "url" : "http//localhost:4000",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Danny Wood Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    

<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="/images/apple-touch-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="/images/apple-touch-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="/images/apple-touch-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="/images/apple-touch-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="/images/apple-touch-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="/images/apple-touch-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32">
<link rel="icon" type="image/png" href="/images/android-chrome-192x192.png?v=M44lzPylqQ" sizes="192x192">
<link rel="icon" type="image/png" href="/images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16">
<link rel="manifest" href="/images/manifest.json?v=M44lzPylqQ">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000">
<link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="/images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="/images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="/assets/css/academicons.css"/>

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>

<!-- end custom head snippets -->

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="/">Danny Wood</a></li>
          
            
            <li class="masthead__menu-item"><a href="/">About Me</a></li>
          
            
            <li class="masthead__menu-item"><a href="/publications/">Publications</a></li>
          
            
            <li class="masthead__menu-item"><a href="/year-archive/">Blog Posts</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="/images/profile.png" class="author__avatar" alt="Danny Wood">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">Danny Wood</h3>
    <p class="author__bio">Postdoc in Machine Learning at University of Manchester</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li><i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> United Kingdom</li>
      
      
      
      
      
       
      
        <li><a href="https://twitter.com/EchoStatements"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
      
      
      
      
        <li><a href="https://www.linkedin.com/in/dannywood4"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
      
      
      
      
      
      
        <li><a href="https://github.com/EchoStatements"><i class="fab fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
        <li><a href="https://scholar.google.com/citations?user=Y0ButvYAAAAJ"><i class="fas fa-fw fa-graduation-cap"></i> Google Scholar</a></li>
      
      
      
      
      
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Visualising the Legendre Transform">
    <meta itemprop="description" content="The Legendre transform is incredibly useful in a wide range of areas including physics, economics, statistics and machine learning. However, its definition can be somewhat opaque. In this post, we look at how we might gain intuition for how the definition works by constructing it from scratch in a visual way.">
    <meta itemprop="datePublished" content="February 04, 2023">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Visualising the Legendre Transform
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  7 minute read
	
</p>
          
        
        
        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2023-02-04T00:00:00-08:00">February 04, 2023</time></p>
        
        
             
        
    
        </header>
      

      <section class="page__content" itemprop="text">
        <p>The <a href="https://en.wikipedia.org/wiki/Legendre_transformation">Legendre transform</a> is incredibly useful in a wide range of areas including physics, economics, statistics and machine learning. However, its definition can be somewhat opaque. In this post, we look at how we might gain intuition for how the definition works by constructing it from scratch in a visual way.</p>

<p>We donâ€™t assume any previous familiarity with the Legendre transform. In fact, the Legendre transform will be motivated and derived over the course of this post. However, we do assume the reader has some basic familiarity with the idea of a <a href="https://en.wikipedia.org/wiki/Convex_function">convex function</a>. Our derivation will also focus more on building intuition than being 100% mathematically precise, though we will give references to more mathematically rigorous sources at the end of the post.</p>

<p>The key idea we will be building towards is this: A convex function defines a curve that can be described in two ways, one explicitly describing where each of the points in the curve lies, the other building the curve using a collection of straight lines.</p>

<p><img src="legendre_transform/output.gif" alt="image" /></p>

<p>By thinking about how to move from one of the description of the curve in terms of points to the one in terms of lines, we will see how the Legendre transform emerges. In doing so, we will build an understanding of the following image, where we go from the orignal convex function (left) to its Legendre transform (right):</p>

<p><img src="legendre_transform/static_legendre.png" alt="image" /></p>

<p>Say we have a convex function $f$. We can draw a curve of that function on a pair of axes by setting $y=f(x)$, drawing each point $(x, f(x))$. By plotting finitely many points, we get an idea of the shape of the curve, if we draw every point we get a continuous curve. This is the usual way of describing the graph of a function.</p>

<p><img src="legendre_transform/points.gif" alt="image" /></p>

<p>But if $f$ is a convex function there is another way of describing the same curve, using the set of lines which never rise above the curve at any point.
<img src="legendre_transform/good_lines.gif" alt="image" /></p>

<p>We can write the equation for a line as $y=mx+c$, where $m$ is the gradient and $c$ is the intercept. Now, for any particular convex curve, some lines will intersect the curve and rise above it, while otherwise will not. To see this, letâ€™s choose a value for the gradient $m$ and try out different, increasing, values of $c$.</p>

<p><img src="legendre_transform/good_lines_bad_lines.gif" alt="image" /></p>

<p>Notice that there is an upper limit on the value of $c$ such that the line doesnâ€™t cut through the curve.</p>

<p>For other values of $m$, there will be no value of $c$ where the line doesnâ€™t cut through the area above the curve.
<img src="legendre_transform/bad_lines.gif" alt="image" /></p>

<p>So there are some values of $m$ for which there are lines with gradient $m$ in $\mathcal{L}$ but others where there arenâ€™t. In the former case, where we can find lines that donâ€™t rise above the curve, how do we find the largest allowed value of $c$? For largest allowable value of $c$, the line touches the curve.<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup></p>

<p>Say that the line touches the curve when $x=x_0$. At this point, we have $f(x_0)=mx_0 + c$. Rearranging, we find the value of $c$ to be $c = f(x_0) - mx_0$. For all other values of $x$, the curve is on/above the line, and therefore $f(x) \geq mx+c$. We can see this in the following image by noting that vertical lines from $mx +c$ always reach <em>up</em> to $f(x)$, as opposed to reaching down.</p>

<p><img src="legendre_transform/tangent.gif" alt="image" /></p>

<p>Again, we can rearrange to get that in general $c \geq f(x) - mx$. But since equality is achieved when $x=x_0$, we have that $c$ is the smallest value that $f(x) - mx$ can take. We can therefore define $c$ by</p>

\[c = \min_{x \in \mathbb{R}} f(x) - mx.\]

<p>We can now plot a new curve: for each $m$, we plot this value of $c$:
<img src="legendre_transform/legendre_c.gif" alt="image" /></p>

<p>Given a gradient $m$, we now have a way of determining the largest value of $c$ that doesnâ€™t give a line which rises above the curve (where such a $c$ exists). From the image above, we see that this mapping (from $m$ to the corresponding value of $c$) gives a line which is tangent to the original curve.</p>

<p>We are almost done, we just need to sort one detail. Notice that we started with a convex curve and ended up with a concave one. This isnâ€™t really a problem but to get to the Legendre transform, we need to make a small tweak: we plot $m$ against $-c$ rather than against $c$, turning the concave curve into a convex one. Looking at the definition of $c$ that we derived, we see that we can turn it into a definition of $-c$ in the form
\(-c = \max_{x \in \mathbb{R}} mx - f(x).\)</p>

<p>And this is how we define the Legendre transform: for a gradient $m$, the Legendre transform of the function $f$ tells us the largest value of $c$ such that $y=mx +c$ doesnâ€™t cut above the curve and flips its sign. Performing the Legendre transform on $f$ gives us the function $f^*$, which acts on a gradient $m$ according to the rule
\(f^\ast(m) = \max_{x \in \mathbb{R}} mx - f(x).\)</p>

<p>A minor technical detail is that the Legendre transform is usually defined using the supremum (the least upper bound of a set) rather than the maximum (the largest element). This definition helps deal with the cases we glossed over earlier where the line approaches the curve in the limit rather than touching it at a finite value.<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup> For the case we considered the maximum and supremum are equivalent, so we may write:</p>

<p>\(f^\ast(m) = \sup_{x \in \mathbb{R}} mx - f(x).\)
And with that, we have arrived at the definition of the Legendre Transform. We can visualise what the transform is doing like so:
<img src="legendre_transform/legendre.gif" alt="image" /></p>

<p>We can now see how the Legendre transform can be used to construct the curve of a convex function from a set of straight lines.
On the left we have $y = f^*(m)$. On the right, we build $y=f(x)$ by taking values of $m$, then plotting $y=mx - f^\ast(m)$. With just a few lines we get a good approximation of the shape of the curve, with the approximation becoming exact if we draw the line for every $m$ gradient where there is a $y=mx+c$ in $\mathcal{L}$.
<img src="legendre_transform/final.gif" alt="image" /></p>

<h2 id="further-reading">Further Reading</h2>

<p>Some resources if you are interested in learning more about the Legendre transform:</p>
<ul>
  <li><a href="https://www2.ph.ed.ac.uk/~mevans/sp/LT070902.pdf">This paper</a>, which gives a more formal treatment, with several example applications</li>
  <li><a href="https://profoundphysics.com/legendre-transformations-for-dummies-intuition-and-examples/">This blog post</a> for an alternative tutorial with an emphasis on application to physics</li>
</ul>

<p><em>If you have any comments or spot any errors in the above, please feel free to reach out to me on <a href="https://twitter.com/EchoStatements">Twitter</a></em></p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>This isnâ€™t strictly true, the highest line to not cut into the area above the curve may just approach the curve in the limit. For clarity of exposition, we leave the handling of this case to footnotes.Â <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p>To see why this is needed, consider the case when $m=0$ for the example curve. We can see that the line $y=2$ lies below the curve and the two will meet in the limit. However, the never actually touch; furthermore for any value greater than 2, a horizontal line at that height will end up above the curve somewhere far to the left.Â <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

        
      </section>

      <footer class="page__meta">
        
        


  




  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#legendre-transform" class="page__taxonomy-item" rel="tag">legendre transform</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#maths" class="page__taxonomy-item" rel="tag">maths</a>
    
    </span>
  </p>




      </footer>

      

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=/posts/2023/02/visualising_the_legendre_transform/" class="btn btn--twitter" title="Share on Twitter"><i class="fab fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=/posts/2023/02/visualising_the_legendre_transform/" class="btn btn--facebook" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=/posts/2023/02/visualising_the_legendre_transform/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fab fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>

      


    </div>

    
  </article>

  
  
</div>

    
    <script src="/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>






  </body>
</html>

